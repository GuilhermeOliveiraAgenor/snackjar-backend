
  generator client {
    provider = "prisma-client-js"
  }

  datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
  }

  model Category{
    id              String  @id @default(uuid())
    name            String
    description     String
    
    recipes Recipe[]

    createdAt DateTime   @default(now()) @map("created_at")
    updatedAt DateTime?  @updatedAt      @map("updated_at")

    @@map("categories")
  }

  enum AuthProvider {
    local
    google
  }

  model User{
    id            String  @id @default(uuid())
    name          String
    email         String  @unique
    password      String?
    googleId      String? @unique
    avatarUrl     String? 
    provider      AuthProvider @default(local)

    createdAt DateTime   @default(now()) @map("created_at")
    updatedAt DateTime?  @updatedAt      @map("updated_at")

    createdRecipes Recipe[] @relation("CreatedByRelation")
    updatedRecipes Recipe[] @relation("UpdatedByRelation")
    deletedRecipes Recipe[] @relation("DeletedByRelation")

    createdRecipeIngredients RecipeIngredient[] @relation("CreatedByRelation")
    updatedRecipeIngredients RecipeIngredient[] @relation("UpdatedByRelation")

    createdRecipeSteps RecipeStep[] @relation("CreatedByRelation")
    updatedRecipeSteps RecipeStep[] @relation("UpdatedByRelation")

    favoriteRecipe FavoriteRecipe[] @relation("CreatedByRelation")

    @@map("users")
  }

  enum RecipeStatus{
      ACTIVE
      INACTIVE
    }

  model Recipe{
    id  String @id @default(uuid())
    title String
    description String
    preparationTime Int
    status RecipeStatus

    categoryId String @map("category_id")
    category Category @relation(fields: [categoryId], references: [id] )

    createdAt DateTime   @default(now()) @map("created_at")
    updatedAt DateTime?  @updatedAt      @map("updated_at")
    deletedAt DateTime?                  @map("deleted_at")

    createdBy String  @map("created_by")
    creator User @relation("CreatedByRelation",fields:[createdBy], references: [id])

    updatedBy String? @map("updated_by")
    updater User? @relation("UpdatedByRelation", fields:[updatedBy], references:[id])

    deletedBy String? @map("deleted_by")
    deleter User? @relation("DeletedByRelation", fields:[deletedBy], references:[id])

    recipeIngredient RecipeIngredient[]
    recipeStep RecipeStep[]
    favoriteRecipe FavoriteRecipe[]

    @@index([status])
    @@index([categoryId])
    @@index([createdBy])
    @@index([updatedBy])
    @@index([deletedBy])

    @@map("recipes")

  }


  enum MeasurementUnit {
    G
    KG
    MG
    ML
    L
    UN
    COLHER
    COLHER_CHA
    COLHER_SOPA
    XICARA
    PITADA
  }

  model RecipeIngredient{
    id String @id @default(uuid())
    ingredient String
    amount String
    unit MeasurementUnit

    recipeId String @map("recipe_id")
    recipe Recipe @relation(fields:[recipeId], references:[id])

    createdAt DateTime   @default(now()) @map("created_at")
    updatedAt DateTime?  @updatedAt      @map("updated_at")

    createdBy String  @map("created_by")
    creator User @relation("CreatedByRelation",fields:[createdBy], references: [id])

    updatedBy String? @map("updated_by")
    updater User? @relation("UpdatedByRelation", fields:[updatedBy], references:[id])

    @@index([recipeId])
    @@index([createdBy])
    @@index([updatedBy])

    @@map("recipe_ingredients")

  }

  model RecipeStep{
    id String @id @default(uuid())
    step Int
    description String

    recipeId String @map("recipe_id")
    recipe Recipe @relation(fields:[recipeId], references:[id])

    createdAt DateTime  @default(now()) @map("created_at")
    updatedAt DateTime? @updatedAt      @map("updated_at")

    createdBy String  @map("created_by")
    creator User @relation("CreatedByRelation",fields:[createdBy], references: [id])

    updatedBy String? @map("updated_by")
    updater User? @relation("UpdatedByRelation", fields:[updatedBy], references:[id])

    @@index([recipeId])
    @@index([createdBy])
    @@index([updatedBy])

    @@map("recipe_steps")

  }

model FavoriteRecipe{
  id String @id @default(uuid())

  recipeId String @map("recipe_id")
  recipe Recipe @relation(fields:[recipeId], references:[id])

  createdBy String @map("created_by")
  user User @relation("CreatedByRelation", fields:[createdBy], references:[id])

  createdAt DateTime   @default(now()) @map("created_at")

  @@index([recipeId])
  @@index([createdBy])

  @@map("favorite_recipes")

}




